---
- name: Add repo key
  apt_repository: repo='ppa:webupd8team/java'
  
- name: Bypass Oracle Popup Window
  shell: "echo debconf shared/accepted-oracle-license-v1-1 select true | sudo debconf-set-selections && echo debconf shared/accepted-oracle-license-v1-1 seen true | sudo debconf-set-selections"
  sudo: yes
  
- name: Install
  apt: pkg=oracle-java8-installer state=installed update_cache=yes

- name: Set JAVA_HOME
  lineinfile:
    dest: /etc/environment
    state: present
    regexp: "{{ item.regex }}"
    line: "{{ item.line }}"
    create: yes
  sudo: yes
  with_items:
    - { regex: "^JAVA_HOME=*", line: "JAVA_HOME=/usr/lib/jvm/java-8-oracle/"}
    - { regex: "^export JAVA_HOME*", line: "export JAVA_HOME"}
